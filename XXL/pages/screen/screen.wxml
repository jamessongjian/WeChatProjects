<view class="screen-container {{styleType === 'male' ? 'male-style' : (styleType === 'female' ? 'female-style' : (styleType === 'clean' ? 'clean-style' : 'neutral-style'))}}">
  <view class="page-mask" wx:if="{{showFavorites}}"></view>
  <!-- æ¸¸ä¹åœºé€‰æ‹©å™¨ - ä¸é¦–é¡µä¿æŒä¸€è‡´ -->
  <view class="park-selector">
    <picker bindchange="onParkChange" value="{{currentParkIndex}}" range="{{parks}}" range-key="name">
      <view class="park-picker">
        <text class="current-park">{{currentPark}}</text>
        <text class="fa fa-chevron-down picker-arrow"></text>
      </view>
    </picker>
  </view>

  <!-- æ¸¸ä¹åœºç»¼åˆä¿¡æ¯å¤§å± -->
  <view class="park-dashboard">
    <view class="dashboard-header">
      <view class="park-name-container">
        <text class="park-name">{{currentPark || 'ç¯çƒå½±åŸ'}}</text>
        <view class="park-status" style="background-color: {{parkStatus.crowdColor || 'rgba(82, 196, 26, 0.9)'}}">
          {{parkStatus.crowdLevel || 'ç©ºé—²'}}
        </view>
      </view>
      <view class="park-time-weather">
        <view class="operating-hours {{isParkCurrentlyOpen ? 'open' : 'closed'}}">
          <text class="hours-icon">ğŸ•</text>
          <text class="hours-text">{{currentParkOperatingHours || 'è¥è¿æ—¶é—´'}}</text>
        </view>
      </view>
    </view>
    
    <!-- ç®€åŒ–çš„ä»ªè¡¨æ¿å†…å®¹ -->
    <view class="dashboard-flex-container">
      <view class="dashboard-metrics">
        <view class="metric-item">
          <text class="metric-label">å¹³å‡ç­‰å¾…</text>
          <text class="metric-value">{{parkStatus.averageWaitTime || '0'}}åˆ†é’Ÿ</text>
        </view>
        <view class="metric-item">
          <text class="metric-label">å¼€æ”¾é¡¹ç›®</text>
          <text class="metric-value">{{parkStatus.openRides || '0'}}/{{parkStatus.totalRides || '0'}}</text>
        </view>
      </view>
      
      <view class="dashboard-content-row">
        <!-- æˆ‘çš„æ”¶è— -->
        <view class="dashboard-section">
          <view class="column-title">
            <text class="title-icon">â­</text>
            <text>æˆ‘çš„æ”¶è—</text>
          </view>
          <view class="attractions-content">
            <block wx:for="{{favoriteItems}}" wx:key="index">
              <view class="hot-attraction" bindtap="handleDashboardItemClick" data-item="{{item}}" data-type="{{item.type}}">
                <view class="attraction-name">{{item.name}}</view>
                <view class="attraction-info-right">
                  <view class="attraction-distance" wx:if="{{item.distanceText}}">{{item.distanceText}}</view>
                  <view class="attraction-wait" style="background-color: {{item.colorTheme === 'green' ? 'rgba(83, 193, 120, 0.9)' : (item.colorTheme === 'orange' ? 'rgba(245, 166, 35, 0.9)' : (item.colorTheme === 'red' ? 'rgba(230, 67, 64, 0.9)' : 'rgba(136, 136, 136, 0.9)'))}}">{{item.waitTime}}{{item.waitUnit}}</view>
                </view>
              </view>
            </block>
            <view class="no-favorites" wx:if="{{!favoriteItems || favoriteItems.length === 0}}">
              <text>æš‚æ— æ”¶è—</text>
            </view>
          </view>
        </view>
        
        <!-- çƒ­é—¨é¡¹ç›® -->
        <view class="dashboard-section">
          <view class="column-title">
            <text class="title-icon">ğŸ”¥</text>
            <text>çƒ­é—¨é¡¹ç›®</text>
          </view>
          <view class="attractions-content">
            <block wx:for="{{hotAttractions}}" wx:key="index">
              <view class="hot-attraction" bindtap="handleDashboardItemClick" data-item="{{item}}" data-type="{{item.type}}">
                <view class="attraction-name">{{item.name}}</view>
                <view class="attraction-info-right">
                  <view class="attraction-distance" wx:if="{{item.distanceText}}">{{item.distanceText}}</view>
                  <view class="attraction-wait" style="background-color: {{item.colorTheme === 'green' ? 'rgba(83, 193, 120, 0.9)' : (item.colorTheme === 'orange' ? 'rgba(245, 166, 35, 0.9)' : (item.colorTheme === 'red' ? 'rgba(230, 67, 64, 0.9)' : 'rgba(136, 136, 136, 0.9)'))}}">{{item.waitTime}}{{item.waitUnit}}</view>
                </view>
              </view>
            </block>
          </view>
          <!-- å±•å¼€/æ”¶èµ·æŒ‰é’® -->
          <view class="expand-button" wx:if="{{hotAttractionsAll.length > 3}}" bindtap="toggleHotAttractions">
            <text class="expand-text">{{hotAttractionsExpanded ? 'æ”¶èµ·' : 'å±•å¼€æ›´å¤š'}} ({{hotAttractionsAll.length}})</text>
            <text class="expand-icon {{hotAttractionsExpanded ? 'expanded' : ''}}">â–¼</text>
          </view>
        </view>
        
        <!-- å³å°†æ¼”å‡º -->
        <view class="dashboard-section">
          <view class="column-title">
            <text class="title-icon">ğŸ­</text>
            <text>ä¸‹ä¸€åœºæ¼”å‡º</text>
          </view>
          <view class="shows-content">
            <block wx:for="{{upcomingShows}}" wx:key="index">
              <view class="upcoming-show" bindtap="handleDashboardItemClick" data-item="{{item}}" data-type="{{item.type}}">
                <view class="show-name">{{item.name}}</view>
                <view class="attraction-info-right">
                  <view class="attraction-distance" wx:if="{{item.distanceText}}">{{item.distanceText}}</view>
                  <view class="attraction-wait" style="background-color: {{item.colorTheme === 'green' ? 'rgba(83, 193, 120, 0.9)' : (item.colorTheme === 'orange' ? 'rgba(245, 166, 35, 0.9)' : (item.colorTheme === 'red' ? 'rgba(230, 67, 64, 0.9)' : 'rgba(136, 136, 136, 0.9)'))}}">{{item.waitTime}}{{item.waitUnit}}</view>
                </view>
              </view>
            </block>
          </view>
          <!-- å±•å¼€/æ”¶èµ·æŒ‰é’® -->
          <view class="expand-button" wx:if="{{upcomingShowsAll.length > 3}}" bindtap="toggleUpcomingShows">
            <text class="expand-text">{{upcomingShowsExpanded ? 'æ”¶èµ·' : 'å±•å¼€æ›´å¤š'}} ({{upcomingShowsAll.length}})</text>
            <text class="expand-icon {{upcomingShowsExpanded ? 'expanded' : ''}}">â–¼</text>
          </view>
        </view>
      </view>
    </view>
    
    <view class="dashboard-notice" wx:if="{{notification}}">
      <text class="notice-icon">ğŸ“¢</text>
      <text class="notice-text">{{notification}}</text>
    </view>
  </view>

  <view class="container">
    <!-- åˆ é™¤äº†ç­›é€‰æ¡å’Œæ•°æ®ç±»å‹å±•ç¤ºåŒºåŸŸ -->
  </view>

  <!-- æ”¶è—æµ®å±‚ -->
  <view class="favorites-mask" wx:if="{{showFavorites}}" bindtap="closeFavoritesPopup" catchtouchmove="preventTouchMove">
    <view class="favorites-popup" catchtap="preventBubble">
      <view class="favorites-container">
        <view class="favorites-main">
          <view class="favorites-title">æˆ‘çš„æ”¶è—</view>
          <scroll-view class="favorites-list" scroll-y>
            <view class="favorite-item" wx:for="{{favorites}}" wx:key="id">
              <view class="favorite-image">
                <image src="{{item.image}}" mode="aspectFill"></image>
                <view class="favorite-name">{{item.name}}</view>
                <view class="favorite-star" bindtap="toggleFavorite" data-item="{{item}}">
                  <text class="star-icon active">â˜…</text>
                </view>
                <view class="detail-button" bindtap="handleViewDetails" data-item="{{item}}">
                  <text class="detail-icon">i</text>
                </view>
                <view class="queue-bubble {{item.queueTime < 30 ? 'low' : (item.queueTime < 50 ? 'medium' : 'high')}}">
                  {{item.queueTime}}
                </view>
              </view>
            </view>
          </scroll-view>
        </view>
        <view class="favorites-sidebar">
          <view class="favorites-title">æ¨èæŸ¥è¯¢</view>
          <view class="recommend-queries">
            <view class="recommend-title">çƒ­é—¨æœç´¢</view>
            <view class="query-item" bindtap="searchQuery" data-query="æœ‰å“ªäº›è¿‡å±±è½¦">æœ‰å“ªäº›è¿‡å±±è½¦</view>
            <view class="query-item" bindtap="searchQuery" data-query="å®¤å†…é¡¹ç›®æœ‰å“ªäº›">å®¤å†…é¡¹ç›®æœ‰å“ªäº›</view>
            <view class="query-item" bindtap="searchQuery" data-query="æ”¯æŒä¼˜é€Ÿé€šçš„é¡¹ç›®">æ”¯æŒä¼˜é€Ÿé€šçš„é¡¹ç›®</view>
            <view class="query-item" bindtap="searchQuery" data-query="ä»Šæ—¥æ¼”å‡ºæ—¶é—´è¡¨">ä»Šæ—¥æ¼”å‡ºæ—¶é—´è¡¨</view>
            <view class="query-item" bindtap="searchQuery" data-query="æ˜å¤©æ—©ä¸Š10ç‚¹åˆ°ï¼Œå¯¹æˆ‘çš„æ”¶è—å¤¹é¡¹ç›®è¿›è¡Œè§„åˆ’ã€‚">æ˜å¤©æ—©ä¸Š10ç‚¹åˆ°ï¼Œè§„åˆ’ä¸‹æˆ‘çš„æ”¶è—å¤¹</view>
          </view>
        </view>
      </view>
    </view>
  </view>

</view> 